---
title: "Reprodicible Research - Project 1"
output: github_document
---

```{r setup, include=FALSE}
library(dplyr)
library(lubridate)
library(ggplot2)
library (knitr)
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.

The dataset can be downloaded from: 

https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip

The variables included in this dataset are:
.	steps: Number of steps taking in a 5-minute interval (missing values are coded as NA)
.	date: The date on which the measurement was taken in YYYY-MM-DD format
.	interval: Identifier for the 5-minute interval in which measurement was taken
The dataset is stored in a comma-separated-value (CSV) file and there are a total of 17,568 observations in this dataset.


## Load and clean the data

From the above URL, the dataset "activity.csv" was loaded into the local working directory. We also need to the date field from convert chars to date format. 

```{r }
activitydata <- read.csv("activity.csv")
activitydata$date <- as.Date(activitydata$date)
```

## What is mean total number of steps taken per day?
#### 1. Calculate total number of steps per day

```{r}
Total_Steps <- activitydata %>%
  filter(!is.na(steps)) %>%
  group_by(date) %>%
  summarize(steps = sum(steps))
Total_Steps

```

##### 2. Plot a histogram of total steps per day:


```{r }

library(ggplot2)

ggplot(Total_Steps, aes(x = steps)) +
        geom_histogram(fill = "firebrick", binwidth = 1000) +
        labs(title = "Daily Steps", x = "Total Steps", y = "Frequency")

```

##### 3.	Calculate and report the mean and median of the total number of steps taken per day 
##### Mean Steps:

```{r}
Mean_Steps<- mean(Total_Steps$steps, na.rm=TRUE)
Mean_Steps
```
##### Median Steps:
```{r}
Median_Steps<- median(Total_Steps$steps, na.rm=TRUE)
Median_Steps

```
### What is the average daily activity pattern?
#### 1.	Make a time series line plot of the 5-minute interval and the average number of steps taken, averaged across all dates
##### Calculate intervals
```{r}
Interval<- activitydata%>%
        group_by(interval)%>%
        filter(!is.na(steps))%>%
        summarise(avg_steps = mean(steps, na.rm=TRUE))
Interval
```
##### Plot average steps
```{r}
ggplot(Interval, aes(x =interval , y=avg_steps)) +
        geom_line(color="firebrick", size=1) +
        labs(title = "Average Daily Steps",
             x = "Interval", 
             y = "Average steps per day")
```

###Imputing missing values
#### Calculate total number of missing values  
```{r}
sum(is.na(activitydata$steps))

```
#### Imputing missing values using mean for each day and create a new dataset with dataset missing values filled in

```{r}
fullactivitydata <- activitydata
nas <- is.na(fullactivitydata$steps)
avg_interval<- tapply(fullactivitydata$steps,
                      fullactivitydata$interval, 
                      mean, 
                      na.rm=TRUE, 
                      simplify = TRUE)
fullactivitydata$steps[nas] <-
  avg_interval[as.character(fullactivitydata$interval[nas])]
names(fullactivitydata)

```

#### Create a histogram of total steps and calculate mean and median steps per day
##### Quick check of the data
```{r}

Total_Steps_All<- fullactivitydata%>%
        group_by(date)%>%
        summarise(total_steps = sum(steps, na.rm=TRUE))
Total_Steps_All

```

##### Plot the histogram
```{r}
ggplot(Total_Steps_All, aes(x = total_steps)) +
        geom_histogram(fill = "firebrick", binwidth = 1000) +
        labs(title = "Daily Steps including Missing values",
             x = "Interval", 
             y = "No. of Steps")

```

##### Compare mean and median with original calculations from the raw dataset


```{r}
Mean_Steps_All<- mean(Total_Steps_All$total_steps, na.rm=TRUE)
Mean_Steps_All
Median_Steps_All<- median(Total_Steps_All$total_steps, na.rm=TRUE)
Median_Steps_All
```

##### What is impact of imputing values? Ans: Because we used the Mean to impute, which is makes the new mean the same as the original. But it's not the same as the original median.


###  Are there differences in activity patterns between weekdays and weekends?
```{r}
head(fullactivitydata)
str(fullactivitydata)
```
##### Create new variable called to indicate weekday or  weekend data:

```{r}

fullactivitydata<- fullactivitydata%>%
        mutate(weektype= 
                 ifelse (weekdays(fullactivitydata$date)=="Saturday"|
        weekdays(fullactivitydata$date)=="Sunday",
                         "Weekend",
                         "Weekday"))

head(fullactivitydata)

```

##### Set up the new interval data 

```{r}
IntervalFull<- fullactivitydata%>%
        group_by(interval, weektype)%>%
        summarise(avg_steps2 = mean(steps, na.rm=TRUE))
head(IntervalFull)

```
##### Plot the new interval data
```{r}
plot<- ggplot(IntervalFull, aes(x =interval ,
                                y=avg_steps2,
                                color=weektype)) +
       geom_line() +
       labs(title = "Daily Steps by Weektype",
            x = "Interval",
            y = "No. of Steps") +
       facet_wrap(~weektype, ncol = 1, nrow=2)
print(plot)

```
